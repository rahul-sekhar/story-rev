<p class="sort" data-current="<%= params[:sort] %>" data-collection="<%= get_collection %>">
    sort by
    <% sort_array = %w[random date title author age price] %>
    <%=raw sort_array.map {|x| link_to x, sort_url(x), :class => params[:sort] == x ? "current" : nil }.join(' | ') %>
</p>

<div class="covers">
    <% if @products.length > 0 %>
        <div class="row">
        <% i = 0 %>
        <% @products.each do |p| %>
            <% i += 1 %>
            <%= render "products/cover", :product => p %>
            <% if i % 4 == 0 %>
        </div>
        <div class="row">
            <% end %>
        <% end %>
        </div>
    <% else %>
        <p class="no-results">No books were found...</p>
    <% end %>
</div>

<%= paginate @products %>